
<section class="min-h-screen bg-gray-50 py-8">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="mb-8" data-aos="fade-up">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">Mi Perfil</h1>
                    <p class="text-gray-600">Información de tu cuenta de moderador</p>
                </div>
                <a href="/moderator" class="text-blue-600 hover:text-blue-700 font-medium">
                    ← Volver al Panel
                </a>
            </div>
        </div>

        <!-- Profile Card -->
        <div class="bg-white rounded-2xl shadow-lg overflow-hidden" data-aos="fade-up" data-aos-delay="100">
            <div id="profileContent" class="p-6">
                <div class="text-center py-12">
                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div>
                    <p class="mt-4 text-gray-600">Cargando perfil...</p>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', async function() {
    const token = localStorage.getItem('token');
    const container = document.getElementById('profileContent');
    
    if (!token) {
        container.innerHTML = `
            <div class="text-center py-12">
                <p class="text-gray-600">No has iniciado sesión</p>
                <a href="/login" class="text-blue-600 mt-4 inline-block">Iniciar sesión</a>
            </div>
        `;
        return;
    }

    try {
        const res = await fetch('/api/moderator/profile', {
            headers: { 'Authorization': `Bearer ${token}` }
        });

        if (!res.ok) {
            throw new Error('Error al cargar perfil');
        }

        const profile = await res.json();
        displayProfile(profile);
    } catch (error) {
        console.error('Error:', error);
        container.innerHTML = `
            <div class="text-center py-12">
                <p class="text-red-600">Error al cargar el perfil</p>
                <p class="text-gray-600 text-sm mt-2">${error.message}</p>
            </div>
        `;
    }
});

function displayProfile(profile) {
    const roleLabels = {
        'adminSistema': 'Administrador del Sistema',
        'adminEvento': 'Administrador de Eventos'
    };

    const container = document.getElementById('profileContent');
    container.innerHTML = `
        <div class="space-y-6">
            <!-- Header Section -->
            <div class="border-b border-gray-200 pb-6">
                <div class="flex items-center space-x-4">
                    <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center">
                        <span class="text-3xl font-bold text-white">${profile.nombreEmpresa?.charAt(0).toUpperCase() || 'M'}</span>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900">${profile.nombreEmpresa || 'Sin nombre'}</h2>
                        <p class="text-gray-600">${profile.email}</p>
                        <span class="inline-block mt-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">
                            ${roleLabels[profile.role] || profile.role}
                        </span>
                    </div>
                </div>
            </div>

            <!-- Information Section -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Información de la Empresa -->
                <div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Información de la Empresa</h3>
                    <div class="space-y-3">
                        <div>
                            <p class="text-sm text-gray-600">Nombre de la Empresa</p>
                            <p class="text-gray-900 font-medium">${profile.nombreEmpresa || 'No especificado'}</p>
                        </div>
                        ${profile.sector ? `
                        <div>
                            <p class="text-sm text-gray-600">Sector</p>
                            <p class="text-gray-900 font-medium">${profile.sector}</p>
                        </div>
                        ` : ''}
                    </div>
                </div>

                <!-- Información de Contacto -->
                ${profile.datosContacto ? `
                <div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Información de Contacto</h3>
                    <div class="space-y-3">
                        ${profile.datosContacto.telefono ? `
                        <div>
                            <p class="text-sm text-gray-600">Teléfono</p>
                            <p class="text-gray-900 font-medium">${profile.datosContacto.telefono}</p>
                        </div>
                        ` : ''}
                        ${profile.datosContacto.direccion ? `
                        <div>
                            <p class="text-sm text-gray-600">Dirección</p>
                            <p class="text-gray-900 font-medium">${profile.datosContacto.direccion}</p>
                        </div>
                        ` : ''}
                    </div>
                </div>
                ` : ''}

                <!-- Representante -->
                ${profile.representante ? `
                <div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Representante</h3>
                    <div class="space-y-3">
                        ${profile.representante.nombre ? `
                        <div>
                            <p class="text-sm text-gray-600">Nombre</p>
                            <p class="text-gray-900 font-medium">${profile.representante.nombre}</p>
                        </div>
                        ` : ''}
                        ${profile.representante.cargo ? `
                        <div>
                            <p class="text-sm text-gray-600">Cargo</p>
                            <p class="text-gray-900 font-medium">${profile.representante.cargo}</p>
                        </div>
                        ` : ''}
                    </div>
                </div>
                ` : ''}

                <!-- Información de la Cuenta -->
                <div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Información de la Cuenta</h3>
                    <div class="space-y-3">
                        <div>
                            <p class="text-sm text-gray-600">Email</p>
                            <p class="text-gray-900 font-medium">${profile.email}</p>
                        </div>
                        ${profile.createdAt ? `
                        <div>
                            <p class="text-sm text-gray-600">Cuenta creada</p>
                            <p class="text-gray-900 font-medium">${new Date(profile.createdAt).toLocaleDateString('es-ES', { 
                                year: 'numeric', 
                                month: 'long', 
                                day: 'numeric' 
                            })}</p>
                        </div>
                        ` : ''}
                    </div>
                </div>
            </div>
        </div>
    `;
}
</script>

